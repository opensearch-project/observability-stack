# Observability Stack Environment Configuration
# Customize these values for your environment

# Compose files to include in addition to docker-compose.yml
# Set to docker-compose.examples.yml to include example services (weather-agent, canary)
# Comment out or leave empty to run only the core observability stack
# Include additional compose files (comment out to disable)
INCLUDE_COMPOSE_EXAMPLES=docker-compose.examples.yml
#INCLUDE_COMPOSE_OTEL_DEMO=docker-compose.otel-demo.yml

OPENSEARCH_DOCKER_REPO=opensearchstaging
#OPENSEARCH_DOCKER_REPO=opensearchproject


# OpenSearch Configuration
#OPENSEARCH_VERSION=3.4.0
OPENSEARCH_VERSION=3.5.0
OPENSEARCH_USER=admin
OPENSEARCH_PASSWORD='My_password_123!@#'
OPENSEARCH_HOST=opensearch
OPENSEARCH_PORT=9200
OPENSEARCH_JAVA_OPTS=-Xms1g -Xmx1g

# OpenSearch Dashboards Configuration
#OPENSEARCH_DASHBOARDS_VERSION=3.4.0
OPENSEARCH_DASHBOARDS_VERSION=3.5.0
OPENSEARCH_DASHBOARDS_PORT=5601

# OpenTelemetry Collector Configuration
OTEL_COLLECTOR_VERSION=0.143.0
OTEL_COLLECTOR_HOST=otel-collector
OTEL_COLLECTOR_PORT_GRPC=4317
OTEL_COLLECTOR_PORT_HTTP=4318
OTEL_COLLECTOR_METRICS_PORT=8888

# Data Prepper Configuration
DATA_PREPPER_VERSION=2.13.0
DATA_PREPPER_OTLP_PORT=21890
DATA_PREPPER_HTTP_PORT=21892

# Prometheus Configuration
PROMETHEUS_VERSION=v3.8.1
PROMETHEUS_HOST=prometheus
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION=15d

# Resource Limits
OPENSEARCH_MEMORY_LIMIT=2G
PROMETHEUS_MEMORY_LIMIT=500M
OTEL_COLLECTOR_MEMORY_LIMIT=500M
DATA_PREPPER_MEMORY_LIMIT=1G
DASHBOARDS_MEMORY_LIMIT=2G
WEATHER_AGENT_MEMORY_LIMIT=200M
CANARY_MEMORY_LIMIT=100M

# Network Configuration
NETWORK_NAME=observability-stack-network

# Example Services Configuration
WEATHER_AGENT_PORT=8000
CANARY_INTERVAL=120

# ******************
# OpenTelemetry Demo Configuration
# ******************
# Demo App version
IMAGE_VERSION=2.2.0
IMAGE_NAME=ghcr.io/open-telemetry/demo
DEMO_VERSION=latest

# Build Args
TRACETEST_IMAGE_VERSION=v1.7.1
OTEL_JAVA_AGENT_VERSION=2.23.0
OPENTELEMETRY_CPP_VERSION=1.24.0

# Dependent images
COLLECTOR_CONTRIB_IMAGE=ghcr.io/open-telemetry/opentelemetry-collector-releases/opentelemetry-collector-contrib:0.142.0
FLAGD_IMAGE=ghcr.io/open-feature/flagd:v0.12.9
GRAFANA_IMAGE=grafana/grafana:12.3.1
JAEGERTRACING_IMAGE=jaegertracing/jaeger:2.12.0
OPENSEARCH_IMAGE=opensearchproject/opensearch:3.4.0
OPENSEARCH_DOCKERFILE=./src/opensearch/Dockerfile
POSTGRES_IMAGE=postgres:17.6
VALKEY_IMAGE=valkey/valkey:9.0.1-alpine3.23
TRACETEST_IMAGE=kubeshop/tracetest:${TRACETEST_IMAGE_VERSION}

# Demo Platform
ENV_PLATFORM=local

# IPv6 Flag control
IPV6_ENABLED=false

# OpenTelemetry Resource Definitions
OTEL_RESOURCE_ATTRIBUTES=service.namespace=opentelemetry-demo,service.version=${IMAGE_VERSION}

# Metrics Temporality
OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE=cumulative

# OTLP Endpoints
OTEL_EXPORTER_OTLP_ENDPOINT=http://${OTEL_COLLECTOR_HOST}:${OTEL_COLLECTOR_PORT_GRPC}
PUBLIC_OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://localhost:8080/otlp-http/v1/traces

# ******************
# Core Demo Services
# ******************
# Ad Service
AD_PORT=9555
AD_ADDR=ad:${AD_PORT}

# Cart Service
CART_PORT=7070
CART_ADDR=cart:${CART_PORT}

# Checkout Service
CHECKOUT_PORT=5050
CHECKOUT_ADDR=checkout:${CHECKOUT_PORT}

# Currency Service
CURRENCY_PORT=7001
CURRENCY_ADDR=currency:${CURRENCY_PORT}

# Email Service
EMAIL_PORT=6060
EMAIL_ADDR=http://email:${EMAIL_PORT}

# Frontend
FRONTEND_PORT=8080
FRONTEND_ADDR=frontend:${FRONTEND_PORT}

# Frontend Proxy (Envoy)
ENVOY_ADDR=0.0.0.0
ENVOY_PORT=8080
ENVOY_ADMIN_PORT=10000
FRONTEND_HOST=frontend

# Image Provider
IMAGE_PROVIDER_HOST=image-provider
IMAGE_PROVIDER_PORT=8081

# Load Generator
LOCUST_WEB_PORT=8089
LOCUST_USERS=5
LOCUST_HOST=http://frontend-proxy:${ENVOY_PORT}
LOCUST_WEB_HOST=load-generator
LOCUST_AUTOSTART=true
LOCUST_HEADLESS=false

# Payment Service
PAYMENT_PORT=50051
PAYMENT_ADDR=payment:${PAYMENT_PORT}

# Product Catalog Service
PRODUCT_CATALOG_PORT=3550
PRODUCT_CATALOG_ADDR=product-catalog:${PRODUCT_CATALOG_PORT}

# Product Reviews Service
PRODUCT_REVIEWS_PORT=3551
PRODUCT_REVIEWS_ADDR=product-reviews:${PRODUCT_REVIEWS_PORT}

# Quote Service
QUOTE_PORT=8090
QUOTE_ADDR=http://quote:${QUOTE_PORT}

# Recommendation Service
RECOMMENDATION_PORT=9001
RECOMMENDATION_ADDR=recommendation:${RECOMMENDATION_PORT}

# Shipping Service
SHIPPING_PORT=50050
SHIPPING_ADDR=http://shipping:${SHIPPING_PORT}

# ******************
# Dependent Services
# ******************
# Flagd
FLAGD_HOST=flagd
FLAGD_PORT=8013
FLAGD_OFREP_PORT=8016

# Flagd UI
FLAGD_UI_HOST=flagd-ui
FLAGD_UI_PORT=4000

# Kafka
KAFKA_PORT=9092
KAFKA_HOST=kafka
KAFKA_ADDR=${KAFKA_HOST}:${KAFKA_PORT}

# LLM service
LLM_HOST=llm
LLM_PORT=8000
LLM_BASE_URL=http://${LLM_HOST}:${LLM_PORT}/v1
LLM_MODEL=astronomy-llm
OPENAI_API_KEY=dummy

# Valkey
VALKEY_PORT=6379
VALKEY_ADDR=valkey-cart:${VALKEY_PORT}

# Postgres
POSTGRES_HOST=postgresql
POSTGRES_PORT=5432
POSTGRES_DB=otel
POSTGRES_PASSWORD=otel
POSTGRES_USER=

# ********************
# Telemetry Components
# ********************
# Grafana
GRAFANA_PORT=3000
GRAFANA_HOST=grafana

# Jaeger
JAEGER_HOST=jaeger
JAEGER_UI_PORT=16686
JAEGER_GRPC_PORT=4317

# Java Options (workaround for OSX JDK bug)
_JAVA_OPTIONS=
